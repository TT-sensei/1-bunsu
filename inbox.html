<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>é­”æ³•ã®ã™ã†ã˜ã€Œ1ã€ã®ã¸ã‚“ã—ã‚“ï¼</title>
    <style>
        body { font-family: 'Helvetica Neue', Arial, sans-serif; background-color: #f0f8ff; text-align: center; padding: 20px; }
        #game-container { background: white; max-width: 500px; margin: 0 auto; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .question { font-size: 2rem; margin-bottom: 20px; font-weight: bold; color: #333; }
        .step-box { background: #fff9c4; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 2px dashed #ffb300; display: none; }
        .fraction-input { font-size: 1.5rem; width: 50px; text-align: center; border: 2px solid #ccc; border-radius: 5px; }
        .fraction-line { border-top: 2px solid #333; width: 50px; margin: 5px auto; }
        button { background: #4caf50; color: white; border: none; padding: 10px 20px; font-size: 1.2rem; border-radius: 50px; cursor: pointer; transition: 0.3s; }
        button:hover { background: #45a049; transform: scale(1.05); }
        #message { margin-top: 20px; font-weight: bold; min-height: 1.5em; }
        .score { font-size: 1.2rem; color: #ff5722; margin-bottom: 10px; }
    </style>
</head>
<body>

<div id="game-container">
    <div class="score">ğŸ”¥ é€£ç¶šã›ã„ã‹ã„: <span id="combo">0</span></div>
    <div id="problem-area" class="question">1 - <span id="q-numerator">?</span>/<span id="q-denominator">?</span></div>

    <div id="step1" class="step-box">
        <p>âœ¨ 1ã‚’åˆ†æ•°ã«ã€Œã¸ã‚“ã—ã‚“ã€ã•ã›ã‚ˆã†ï¼</p>
        <div style="display: inline-block;">
            <input type="number" id="henshin-num" class="fraction-input"><br>
            <div class="fraction-line"></div>
            <input type="number" id="henshin-den" class="fraction-input">
        </div>
        <br><br>
        <button onclick="checkStep1()">ã¸ã‚“ã—ã‚“ï¼</button>
    </div>

    <div id="step2" class="step-box">
        <p>ğŸ“ ã²ãç®—ã‚’ã—ã‚ˆã†ï¼</p>
        <span id="display-henshin">5/5</span> - <span id="display-orig">2/5</span> = 
        <div style="display: inline-block; vertical-align: middle;">
            <input type="number" id="final-num" class="fraction-input"><br>
            <div class="fraction-line"></div>
            <input type="number" id="final-den" class="fraction-input" readonly>
        </div>
        <br><br>
        <button onclick="checkFinal()">ã“ãŸãˆã‚ã‚ã›</button>
    </div>

    <div id="message"></div>
</div>

<script>
    let qDen, qNum, combo = 0;

    function initGame() {
        qDen = Math.floor(Math.random() * 8) + 2; // åˆ†æ¯ 2~9
        qNum = Math.floor(Math.random() * (qDen - 1)) + 1; // åˆ†å­ 1~åˆ†æ¯æœªæº€
        
        document.getElementById('q-numerator').innerText = qNum;
        document.getElementById('q-denominator').innerText = qDen;
        document.getElementById('message').innerText = "ã¾ãšã¯ã€Œ1ã€ã‚’ã¸ã‚“ã—ã‚“ã•ã›ã¦ã­ï¼";
        document.getElementById('step1').style.display = 'block';
        document.getElementById('step2').style.display = 'none';
        
        // ã‚¯ãƒªã‚¢
        document.querySelectorAll('input').forEach(i => i.value = '');
    }

    function checkStep1() {
        const hNum = document.getElementById('henshin-num').value;
        const hDen = document.getElementById('henshin-den').value;
        
        if(hNum == qDen && hDen == qDen) {
            document.getElementById('message').innerText = "ã™ã”ã„ï¼æ­£è§£ï¼ãã®ã¾ã¾è¨ˆç®—ã ï¼";
            document.getElementById('display-henshin').innerText = `${hNum}/${hDen}`;
            document.getElementById('display-orig').innerText = `${qNum}/${qDen}`;
            document.getElementById('final-den').value = qDen;
            document.getElementById('step1').style.display = 'none';
            document.getElementById('step2').style.display = 'block';
        } else {
            document.getElementById('message').innerText = `ãŠã£ã¨ï¼ã²ãåˆ†æ•°ã®ä¸‹ã®æ•°å­—ã€Œ${qDen}ã€ã«åˆã‚ã›ã¦ã¿ã¦ï¼`;
        }
    }

    function checkFinal() {
        const fNum = document.getElementById('final-num').value;
        if(fNum == (qDen - qNum)) {
            combo++;
            document.getElementById('combo').innerText = combo;
            document.getElementById('message').innerText = "âœ¨å®Œãƒšã‚­ï¼âœ¨ ã¤ãã®å•é¡Œã«ã„ãã‚ˆï¼";
            setTimeout(initGame, 1500);
        } else {
            document.getElementById('message').innerText = "ãŠã—ã„ï¼ä¸Šã®æ•°å­—ã ã‘å¼•ãç®—ã—ã¦ã¿ã¦ã€‚";
        }
    }

    initGame();
</script>

</body>
</html>
